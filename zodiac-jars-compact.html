<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zodiac Jars - Compact</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 8px;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 8px;
        }

        .header h1 {
            color: #ffffff;
            font-size: 1.2em;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            margin-bottom: 3px;
        }

        .header p {
            color: #a8b2d1;
            font-size: 0.65em;
        }

        .jars-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 6px;
            flex: 1;
            overflow: hidden;
        }

        .jar-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 0;
        }

        .jar-label {
            font-size: 0.55em;
            font-weight: 600;
            margin-bottom: 2px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .jar-dates {
            font-size: 0.45em;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 3px;
        }

        .jar {
            width: 100%;
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid;
            border-radius: 8px 8px 12px 12px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
        }

        .jar-symbol {
            position: absolute;
            top: 3px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2em;
            opacity: 0.2;
            z-index: 1;
        }

        .jar-contents {
            position: absolute;
            bottom: 5px;
            left: 5px;
            right: 5px;
            top: 25px;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-end;
            gap: 3px;
        }

        .star {
            width: 14px;
            height: 14px;
            position: relative;
            animation: dropIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), twinkle 2s ease-in-out infinite;
            flex-shrink: 0;
        }

        .star::before {
            content: '⭐';
            font-size: 14px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        @keyframes dropIn {
            0% {
                transform: translateY(-150px) rotate(0deg) scale(0.5);
                opacity: 0;
            }
            100% {
                transform: translateY(0) rotate(360deg) scale(1);
                opacity: 1;
            }
        }

        @keyframes twinkle {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .count {
            position: absolute;
            top: 3px;
            right: 3px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.6em;
            z-index: 2;
        }

        /* Zodiac-specific colors */
        .aries { border-color: #ff6b6b; }
        .aries .jar-label { color: #ff6b6b; }
        .aries .star::before { color: #ff6b6b; }

        .taurus { border-color: #51cf66; }
        .taurus .jar-label { color: #51cf66; }
        .taurus .star::before { color: #51cf66; }

        .gemini { border-color: #ffd43b; }
        .gemini .jar-label { color: #ffd43b; }
        .gemini .star::before { color: #ffd43b; }

        .cancer { border-color: #a9e34b; }
        .cancer .jar-label { color: #a9e34b; }
        .cancer .star::before { color: #a9e34b; }

        .leo { border-color: #ff922b; }
        .leo .jar-label { color: #ff922b; }
        .leo .star::before { color: #ff922b; }

        .virgo { border-color: #8ce99a; }
        .virgo .jar-label { color: #8ce99a; }
        .virgo .star::before { color: #8ce99a; }

        .libra { border-color: #ff8787; }
        .libra .jar-label { color: #ff8787; }
        .libra .star::before { color: #ff8787; }

        .scorpio { border-color: #cc5de8; }
        .scorpio .jar-label { color: #cc5de8; }
        .scorpio .star::before { color: #cc5de8; }

        .sagittarius { border-color: #845ef7; }
        .sagittarius .jar-label { color: #845ef7; }
        .sagittarius .star::before { color: #845ef7; }

        .capricorn { border-color: #5c7cfa; }
        .capricorn .jar-label { color: #5c7cfa; }
        .capricorn .star::before { color: #5c7cfa; }

        .aquarius { border-color: #22b8cf; }
        .aquarius .jar-label { color: #22b8cf; }
        .aquarius .star::before { color: #22b8cf; }

        .pisces { border-color: #91a7ff; }
        .pisces .jar-label { color: #91a7ff; }
        .pisces .star::before { color: #91a7ff; }
    </style>
</head>
<body>
    <div class="header">
        <h1>✨ Zodiac Community ✨</h1>
        <p>Type: !aries or !taurus or !gemini...</p>
    </div>

    <div class="jars-container" id="jarsContainer"></div>

    <script>
        const zodiacSigns = [
            { name: 'Aries', class: 'aries', command: '!aries', symbol: '♈', dates: 'Mar 21 - Apr 19' },
            { name: 'Taurus', class: 'taurus', command: '!taurus', symbol: '♉', dates: 'Apr 20 - May 20' },
            { name: 'Gemini', class: 'gemini', command: '!gemini', symbol: '♊', dates: 'May 21 - Jun 20' },
            { name: 'Cancer', class: 'cancer', command: '!cancer', symbol: '♋', dates: 'Jun 21 - Jul 22' },
            { name: 'Leo', class: 'leo', command: '!leo', symbol: '♌', dates: 'Jul 23 - Aug 22' },
            { name: 'Virgo', class: 'virgo', command: '!virgo', symbol: '♍', dates: 'Aug 23 - Sep 22' },
            { name: 'Libra', class: 'libra', command: '!libra', symbol: '♎', dates: 'Sep 23 - Oct 22' },
            { name: 'Scorpio', class: 'scorpio', command: '!scorpio', symbol: '♏', dates: 'Oct 23 - Nov 21' },
            { name: 'Sagittarius', class: 'sagittarius', command: '!sagittarius', symbol: '♐', dates: 'Nov 22 - Dec 21' },
            { name: 'Capricorn', class: 'capricorn', command: '!capricorn', symbol: '♑', dates: 'Dec 22 - Jan 19' },
            { name: 'Aquarius', class: 'aquarius', command: '!aquarius', symbol: '♒', dates: 'Jan 20 - Feb 18' },
            { name: 'Pisces', class: 'pisces', command: '!pisces', symbol: '♓', dates: 'Feb 19 - Mar 20' }
        ];

        const jarCounts = {};

        function initializeJars() {
            const container = document.getElementById('jarsContainer');
            
            zodiacSigns.forEach(sign => {
                jarCounts[sign.class] = 0;
                
                const wrapper = document.createElement('div');
                wrapper.className = 'jar-wrapper';
                
                const label = document.createElement('div');
                label.className = `jar-label ${sign.class}`;
                label.textContent = sign.name;
                
                const dates = document.createElement('div');
                dates.className = 'jar-dates';
                dates.textContent = sign.dates;
                
                const jar = document.createElement('div');
                jar.className = `jar ${sign.class}`;
                jar.id = `jar-${sign.class}`;
                
                const symbol = document.createElement('div');
                symbol.className = 'jar-symbol';
                symbol.textContent = sign.symbol;
                
                const count = document.createElement('div');
                count.className = 'count';
                count.id = `count-${sign.class}`;
                count.textContent = '0';
                
                const contents = document.createElement('div');
                contents.className = 'jar-contents';
                contents.id = `contents-${sign.class}`;
                
                jar.appendChild(symbol);
                jar.appendChild(count);
                jar.appendChild(contents);
                wrapper.appendChild(label);
                wrapper.appendChild(dates);
                wrapper.appendChild(jar);
                container.appendChild(wrapper);
            });
        }

        function addStar(signClass) {
            const contents = document.getElementById(`contents-${signClass}`);
            const count = document.getElementById(`count-${signClass}`);
            
            if (!contents) return;
            
            const star = document.createElement('div');
            star.className = 'star';
            
            contents.appendChild(star);
            
            jarCounts[signClass]++;
            count.textContent = jarCounts[signClass];
            
            // Keep max 60 stars for performance
            if (contents.children.length > 60) {
                contents.removeChild(contents.firstChild);
            }
        }

        function processChatCommand(message) {
            const lowerMessage = message.toLowerCase().trim();
            
            zodiacSigns.forEach(sign => {
                if (lowerMessage === sign.command) {
                    addStar(sign.class);
                }
            });
        }

        initializeJars();
        window.processChatCommand = processChatCommand;
        
        // Listen for commands from control dashboard
        window.addEventListener('storage', function(e) {
            if (e.key === 'streamCommand') {
                try {
                    const command = JSON.parse(e.newValue);
                    if (command.widget === 'zodiac') {
                        handleDashboardCommand(command.command, command.data);
                    }
                } catch (err) {
                    console.error('Error processing command:', err);
                }
            }
        });
        
        function handleDashboardCommand(command, data) {
            switch(command) {
                case 'add':
                    addStar(data);
                    break;
                case 'simulate':
                    for (let i = 0; i < (data.count || 15); i++) {
                        setTimeout(() => {
                            const randomSign = zodiacSigns[Math.floor(Math.random() * zodiacSigns.length)];
                            addStar(randomSign.class);
                        }, i * 200);
                    }
                    break;
                case 'clear':
                    zodiacSigns.forEach(sign => {
                        const contents = document.getElementById(`contents-${sign.class}`);
                        const count = document.getElementById(`count-${sign.class}`);
                        if (contents) contents.innerHTML = '';
                        if (count) {
                            jarCounts[sign.class] = 0;
                            count.textContent = '0';
                        }
                    });
                    break;
            }
        }
    </script>
</body>
</html>
